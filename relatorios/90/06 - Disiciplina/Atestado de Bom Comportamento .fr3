<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41115,501972662" ScriptLanguage="PascalScript" ScriptText.Text="procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile('..\config\dbxconnections.ini');    &#13;&#10; &#13;&#10;  SqlListaInterno.Open;&#13;&#10;  while not SqlListaInterno.EOF do&#13;&#10;    begin&#13;&#10;    &#13;&#10;    ComboBox1.Items.Add(SqlListaInterno.FieldByName('NOME_INTERNO').AsString);  &#13;&#10;     &#13;&#10;    SqlListaInterno.Next;&#13;&#10;&#13;&#10;      SqlFuncionario.Open;&#13;&#10;        &#13;&#10;  while not SqlFuncionario.EOF do&#13;&#10;    begin&#13;&#10;    &#13;&#10;    ComboBox2.Items.Add(SqlFuncionario.FieldByName('NOME_FUNCIONARIO').AsString);  &#13;&#10;     &#13;&#10;    SqlFuncionario.Next;&#13;&#10;      &#13;&#10;    end;                          &#13;&#10;        &#13;&#10;      &#13;&#10;    end;                          &#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;    &#13;&#10;  &#13;&#10;procedure Memo2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;      &#13;&#10;end;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  { if combobox1.itemindex &#62;=0 then&#13;&#10;    begin&#13;&#10;        sqlcomportamento.sql.text:= sqlcomportamento.sql.text+' and i.nome_interno = ' + '''' +&#13;&#10;        combobox1.text + '''' ;&#13;&#10;        sqlcomportamento.close;&#13;&#10;        sqlcomportamento.open;                                                        &#13;&#10;    end&#13;&#10;    else&#13;&#10;    if trim(editprontuario.text) &#60;&#62; '' then&#13;&#10;    begin&#13;&#10;        sqlcomportamento.sql.text:= sqlcomportamento.sql.text+' and i.rgi = ' + editprontuario.text;&#13;&#10;        sqlcomportamento.close;&#13;&#10;        sqlcomportamento.open;  &#13;&#10;    end&#13;&#10;    else}  &#13;&#10;    begin&#13;&#10;      //  showmessage('Selecione um interno ou informe um número de prontuário válido.');                                                                                                                                                                                 &#13;&#10;    end; {                &#13;&#10;     &#13;&#10;&#13;&#10;  SqlListaInterno.First;&#13;&#10;  while not SqlComportamento.EOF do&#13;&#10;  begin&#13;&#10;    if ComboBox1.Itemindex = SqlListaInterno.recno then&#13;&#10;    begin&#13;&#10;      EditProntuario.text := SqlComportamento.FieldByName('RGI').AsString;                                   &#13;&#10;      break;               &#13;&#10;    end;              &#13;&#10;  &#13;&#10;    SqlListaInterno.Next;&#13;&#10;     &#13;&#10;  &#13;&#10;&#13;&#10;  end;    }         &#13;&#10;end;  &#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{  IF &#60;GLOBAL_CONFERE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;    SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;  }    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnCloseQuery(Sender: TfrxComponent; var CanClose: Boolean);&#13;&#10;begin&#13;&#10;                              &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;  &#13;&#10;  &#13;&#10;procedure Button2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                                                                &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox2OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure EditProntuarioOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;//    MEMO2.LINES.TEXT := SQLCOMPORTAMENTO.SQL.TEXT;                                                                                        &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label5OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  {  if combobox1.itemindex &#62;= 0 then&#13;&#10;    begin&#13;&#10;        memo2.lines.text := sqlcomportamento.sql.text+' and i.nome_interno = ' + '''' +&#13;&#10;        combobox1.text + '''' ;&#13;&#10;                                                        &#13;&#10;    end&#13;&#10;    else&#13;&#10;    if trim(editprontuario.text) &#60;&#62; '' then&#13;&#10;    begin&#13;&#10;       memo2.lines.text := sqlcomportamento.sql.text+' and i.rgi = ' + editprontuario.text;&#13;&#10;  &#13;&#10;    end&#13;&#10;    else&#13;&#10;    begin&#13;&#10;        showmessage('Selecione um interno ou informe um número de prontuário válido.');                                                                                                                                                                                 &#13;&#10;    end; }       &#13;&#10;end;&#13;&#10;&#13;&#10;begin                      &#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C75702200010C3A00000020446174615365743D2253716C436F6D706F7274616D656E746F2220446174615365744E616D653D2253716C436F6D706F7274616D656E746F2200010C3800000020446174615365743D2253716C4C69737461496E7465726E6F2220446174615365744E616D653D2253716C4C69737461496E7465726E6F2200010C3600000020446174615365743D2253716C46756E63696F6E6172696F2220446174615365744E616D653D2253716C46756E63696F6E6172696F2200010C2C00000020446174615365743D2273716C66756E63616F2220446174615365744E616D653D2273716C66756E63616F2200010C3000000020446174615365743D2273716C5F64697265746F722220446174615365744E616D653D2273716C5F64697265746F72220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C16000000204E616D653D22474C4F42414C5F434F4E464552452200010C0B000000204E616D653D225247492200010C19000000204E616D653D2249445F5550222056616C75653D223130362200010C3A000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F20444953545249544F204645444552414C272200010C45000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D222753454352455441524941204445205345475552414EC741205055424C494341272200010C49000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D22275355425345435245544152494120444F2053495354454D412050454E4954454E43494152494F27220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXDatabase Name="Database" ConnectionName="IBConnection" DriverName="Interbase" GetDriverFunc="getSQLDriverINTERBASE" LibraryName="dbexpint.dll" LoginPrompt="False" Params.Text="" VendorLib="gds32.dll" PropData="05704C65667403B0000470546F70023C"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;left join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP&#13;&#10;  " Database="Database" PropData="05704C65667402640470546F700380000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlComportamento" UserName="SqlComportamento" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select i.tipoconduta, i.nome_interno,i.pai,i.mae,i.rgi, up.nome_up                                                                                                     &#13;&#10;from interno i&#13;&#10;inner join unidade_penal up on (up.id_up = i.id_up)      &#13;&#10;where UPPER(i.tipoconduta) = 'BOM'  and i.id_up = :ID_UP&#13;&#10;and ((i.nome_interno = :interno)  or (i.rgi = :rgi))    &#13;&#10;ORDER BY I.NOME_INTERNO                                                        &#13;&#10;&#13;&#10;                        " Database="Database" PropData="05704C65667403E0010470546F700398000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B2200010C3F000000204E616D653D22696E7465726E6F222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F78312E746578742200010C40000000204E616D653D22726769222044617461547970653D226674537472696E67222045787072657373696F6E3D226564697470726F6E74756172696F2E74657874220000"/>
    <TfrxDBXQuery Name="SqlListaInterno" UserName="SqlListaInterno" CloseDataSource="True" FieldAliases.Text="" SQL.Text="  select&#13;&#10;i.nome_interno,&#13;&#10;i.id_interno&#13;&#10;from interno i    &#13;&#10;where I.ST = 'A'&#13;&#10;and I.ID_UP = :ID_UP&#13;&#10;and coalesce(i.nome_interno,'')&#60;&#62;''&#13;&#10;and i.tipoconduta = 'Bom'&#13;&#10;order by I.nome_interno&#13;&#10;  " Database="Database" PropData="05704C65667402280470546F7002150A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="SqlFuncionario" UserName="SqlFuncionario" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT f.nome_funcionario, f.funcao &#13;&#10;FROM funcionario f&#13;&#10;    &#13;&#10;where f.id_up = :ID_UP&#13;&#10;ORDER BY F.NOME_FUNCIONARIO                                                &#13;&#10;           " Database="Database" PropData="05704C65667403B0000470546F7003BC000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlfuncao" UserName="sqlfuncao" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select funcao &#13;&#10;from funcionario &#13;&#10;where nome_funcionario like '%' || :nome || '%'              " Database="Database" PropData="05704C65667402640470546F7003BC000A506172616D657465727301010C3C000000204E616D653D226E6F6D65222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F78322E74657874220000"/>
    <TfrxDBXQuery Name="sql_diretor" UserName="sql_diretor" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select f.nome_funcionario AS diretor, f.funcao&#13;&#10;from funcionario f&#13;&#10;where f.funcao like '%DIRETOR%'&#13;&#10;and id_up = :id_up                                             " Database="Database" PropData="05704C65667403E0010470546F7003D8000A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="293" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="">
    <TfrxPageFooter Name="PageFooter1" Height="26,45671" Left="0" Top="888,18955" Width="718,1107">
      <TfrxMemoView Name="Memo19" Left="0" Top="7,55906" Width="714,33117" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxPageHeader Name="PageHeader1" Height="113,3859" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo10" Left="3,77953" Top="5,66141" Width="718,1107" Height="64,25201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="3,77953" Top="70,13389" Width="718,1107" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture3" Left="597,16574976" Top="0" Width="109,60629921" Height="105,82677165" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture4" Left="13,55906" Top="1,77952512" Width="109,60629921" Height="105,82677165" FileLink="..\logo\esquerda.jpg"/>
    </TfrxPageHeader>
    <TfrxMasterData Name="MasterData1" Height="373,7718" Left="0" Top="192,75603" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="SqlComportamento" DataSetName="SqlComportamento" RowCount="0">
      <TfrxRichView Name="Rich1" Left="22,67718" Top="217,57483" Width="676,53587" Height="132,28355" GapX="2" GapY="1" PropData="0852696368456469740AE40100007B5C727466315C616E73695C616E7369637067313235325C64656666305C6465666C616E67313034367B5C666F6E7474626C7B5C66305C666E696C5C66636861727365743020417269616C3B7D7B5C66315C666E696C5C666368617273657430206167656E63792046423B7D7D0D0A5C766965776B696E64345C7563315C706172645C6669313434305C716A5C66733238204465206F7264656D20646F2044697265746F7220646F286129205B53716C436F6D706F7274616D656E746F2E224E4F4D455F5550225D2C2044722E205B53716C5F64697265746F722E2264697265746F72225D2C2061746573746F20717565206F20736574656E636961646F205B53716C436F6D706F7274616D656E746F2E224E4F4D455F494E5445524E4F225D2C2070726F6E74755C27653172696F205B53716C436F6D706F7274616D656E746F2E22524749225D2C2066696C686F206465205B53716C436F6D706F7274616D656E746F2E22504149225D2065205B53716C436F6D706F7274616D656E746F2E224D4145225D2C207265636F6C6869646F20617475616C6D656E7465206E657374612050656E6974656E63695C2765317269612C20656E636F6E7472612D7365206E6F20626F6D20636F6D706F7274616D656E746F2E205C66315C7061720D0A7D0D0A00"/>
      <TfrxMemoView Name="Memo1" Left="266,93723" Top="86,92919" Width="207,87415" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-24" Font.Name="Arial" Font.Style="5" HAlign="haCenter" ParentFont="False" Text="A T E S T A D O"/>
    </TfrxMasterData>
    <TfrxColumnFooter Name="ColumnFooter1" Height="239,55133" Left="0" Top="627,40198" Width="718,1107">
      <TfrxMemoView Name="SqlupCIDADE" Left="166,06308" Top="49,13389" Width="532,91373" Height="18,89765" DataSet="Sqlup" DataSetName="Sqlup" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd &#34;de&#34; mmmmmmmm &#34;de&#34; yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Sqlup.&#34;CIDADE&#34;], [date]"/>
      <TfrxMemoView Name="SqlListaInternoID_INTERNO" Left="212,05535" Top="155,94496" Width="325,03958" Height="22,67718" DataSet="SqlListaInterno" DataSetName="SqlListaInterno" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[ComboBox2.text]"/>
      <TfrxMemoView Name="SqlFuncionarioFUNCAO" Left="214,5671" Top="180,14966" Width="321,26005" Height="18,89765" DataSet="SqlFuncionario" DataSetName="SqlFuncionario" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[SqlFuncao.&#34;FUNCAO&#34;]"/>
    </TfrxColumnFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Informe Interno ou Prontuário" Height="178" Left="372" Top="130" Width="448" OnCloseQuery="DialogPage1OnCloseQuery" OnShow="DialogPage1OnShow">
    <TfrxLabelControl Name="Label1" Left="10" Top="8" Width="72" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Interno" Color="15854311"/>
    <TfrxButtonControl Name="Button1" Left="264" Top="85" Width="75" Height="21" Caption="OK" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="355" Top="85" Width="75" Height="21" Caption="Cancelar" ModalResult="2" OnClick="Button2OnClick"/>
    <TfrxComboBoxControl Name="ComboBox1" Left="10" Top="35" Width="273" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnChange="ComboBox1OnChange"/>
    <TfrxLabelControl Name="Label2" Left="288" Top="8" Width="101" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Prontuário" Color="15854311" OnClick="Label2OnClick"/>
    <TfrxEditControl Name="EditProntuario" Left="288" Top="34" Width="141" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0" OnClick="EditProntuarioOnClick"/>
    <TfrxLabelControl Name="Label3" Left="11" Top="60" Width="112" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Funcionário" Color="15854311" OnClick="Label2OnClick"/>
    <TfrxLabelControl Name="Label5" Left="63" Top="117" Width="315" Height="18" Font.Charset="1" Font.Color="255" Font.Height="-15" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Digitar o nome do Interno ou o Prontuário." Color="15854311" OnClick="Label5OnClick"/>
    <TfrxComboBoxControl Name="ComboBox2" Left="12" Top="86" Width="249" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox2OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
