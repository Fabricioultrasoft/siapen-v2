<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41129,6703137153" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;    &#13;&#10;begin&#13;&#10;Database.Params.LoadFromFile('..\config\dbxconnections.ini');    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10; IF &#60;GLOBAL_VISITANTE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;   SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;    &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3200000020446174615365743D2273716C7669736974616E74652220446174615365744E616D653D2273716C7669736974616E74652200010C2A00000020446174615365743D2273716C426C6F636F2220446174615365744E616D653D2273716C426C6F636F2200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C7570220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C24000000204E616D653D22474C4F42414C5F5649534954414E5445222056616C75653D222752272200010C19000000204E616D653D2249445F5550222056616C75653D223130362200010C34000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D22274D494E495354C952494F204441204A55535449C741272200010C49000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D2227444550415254414D454E544F2050454E4954454E4349C152494F204E4143494F4E414C272200010C4B000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D222744495245544F52494120444F2053495354454D412050454E4954454E4349C152494F20444F20444627220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqlvisitante" UserName="sqlvisitante" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select v.visitante, i.nome_interno, gp.grau_parentesco,&#13;&#10;V.STATUS, up.sigla,  c.cela, s.solario, p.pavilhao, &#13;&#10;i.rgi, G.GALERIA, v.rg, v.data_nascimento,v.DATA_ULT_VISITA,        &#13;&#10;V.ORGAO_EXPEDIDOR,v.data_cadastro                                                                     &#13;&#10;  &#13;&#10;from interno i&#13;&#10;left join visitante v on (i.id_interno = v.id_interno)&#13;&#10;left join visitante_interno vi on (v.id_visitante = vi.id_visitante)&#13;&#10;left join grau_parentesco gp on (vi.id_grau_parentesco = gp.id_grau_parentesco)&#13;&#10;inner join cela c on (i.idcela = c.id_cela)&#13;&#10;inner join solario s on (i.idsolario = s.id_solario)&#13;&#10;inner join pavilhao p on (i.idpavilhao = p.id_pavilhao)&#13;&#10;inner join GALERIA G on (i.idGALERIA = G.id_GALERIA)&#13;&#10;inner join unidade_penal up on (i.id_up = up.id_up)&#13;&#10;&#13;&#10;  &#13;&#10;       where i.id_up = :id_up&#13;&#10;       AND  ((V.STATUS = 'A') and (coalesce(v.visitante,'')&#60;&#62;''))&#13;&#10;       order by i.nome_interno, v.visitante&#13;&#10;             &#13;&#10;       &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;                    &#13;&#10;&#13;&#10;                                    " Database="Database" PropData="05704C656674024C0470546F70026C0A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="sqlBloco" UserName="sqlBloco" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select distinct g.galeria&#13;&#10;from interno i&#13;&#10;       inner join galeria g on (g.id_galeria = i.idgaleria)&#13;&#10;where i.id_up = :id_up                                             &#13;&#10;and coalesce(i.nome_interno, '')&#60;&#62;''&#13;&#10;order by i.nome_interno&#13;&#10;    &#13;&#10;    " Database="Database" PropData="05704C656674024C0470546F70022C0A506172616D657465727301010C3F000000204E616D653D2269645F7570222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C6566740390000470546F7002680A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="IBConnection" DriverName="Interbase" GetDriverFunc="getSQLDriverINTERBASE" LibraryName="dbexpint.dll" LoginPrompt="False" Params.Text="" VendorLib="gds32.dll" PropData="05704C6566740390000470546F70022C"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="5" BottomMargin="10" Columns="1" ColumnWidth="293" ColumnPositions.Text="0" Frame.Width="0,5" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="12,09448819" Left="0" Top="234,33086" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="sqlvisitante" DataSetName="sqlvisitante" RowCount="0">
      <TfrxMemoView Name="sqlvisitanteVISITANTE" Left="22,67718" Top="0" Width="241,88992" Height="12,09448819" StretchMode="smActualHeight" DataField="VISITANTE" DataSet="sqlvisitante" DataSetName="sqlvisitante" Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text="[sqlvisitante.&#34;VISITANTE&#34;]"/>
      <TfrxMemoView Name="Memo23" Left="0" Top="0" Width="22,67718" Height="12,09448819" StretchMode="smActualHeight" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text="[LINE]"/>
      <TfrxMemoView Name="Memo4" Left="332,59864" Top="0" Width="56,69295" Height="12,09448819" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text="[sqlvisitante.&#34;RG&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="434,64595" Top="0" Width="71,81107" Height="12,09448819" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text="[sqlvisitante.&#34;data_nascimento&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="582,04762" Top="0" Width="75,5906" Height="12,09448819" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text="[SQLVISITANTE.&#34;DATA_CADASTRO&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="389,29159" Top="0" Width="45,35436" Height="12,09448819" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text="[SQLVISITANTE.&#34;ORGAO_EXPEDIDOR&#34;]"/>
      <TfrxMemoView Name="Memo5" ShiftMode="smWhenOverlapped" Left="657,63822" Top="0" Width="60,47248" Height="12,09448819" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo17" Left="264,5671" Top="0" Width="68,03154" Height="12,09448819" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" VAlign="vaCenter" Text="[sqlvisitante.&#34;data_ult_visita&#34;]"/>
      <TfrxMemoView Name="Memo1" Left="506,45702" Top="0" Width="75,5906" Height="12,09448819" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Style="fsDot" Frame.Typ="11" ParentFont="False" Text="[sqlvisitante.&#34;GRAU_PARENTESCO&#34;]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="12,77952268" Left="0" ParentFont="False" Top="200,31509" Width="718,1107" Condition="&#60;sqlvisitante.&#34;nome_interno&#34;&#62;">
      <TfrxShapeView Name="Shape2" ShiftMode="smWhenOverlapped" Left="0" Top="0,44094" Width="718,1107" Height="11,33858268" Color="-16777201"/>
      <TfrxMemoView Name="Memo18" ShiftMode="smWhenOverlapped" Left="0,75590063" Top="1,44094" Width="75,5906" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="Interno:"/>
      <TfrxMemoView Name="sqlvisitanteNOME_INTERNO1" ShiftMode="smWhenOverlapped" Left="75,14966" Top="1" Width="498,89796" Height="11,33858268" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="[sqlvisitante.&#34;NOME_INTERNO&#34;] -  [sqlvisitante.&#34;RGI&#34;]"/>
      <TfrxMemoView Name="sqlvisitantePAVILHAO" ShiftMode="smWhenOverlapped" Left="487,07112" Top="0" Width="230,55133" Height="11,33858268" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[sqlvisitante.&#34;sigla&#34;] - [sqlvisitante.&#34;GALERIA&#34;] - [sqlvisitante.&#34;SOLARIO&#34;] - [sqlvisitante.&#34;CELA&#34;]  "/>
    </TfrxGroupHeader>
    <TfrxColumnHeader Name="ColumnHeader1" Height="119,28355" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo3" Left="0" Top="89,04731" Width="718,1107" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Arial" Font.Style="1" Frame.Typ="12" HAlign="haCenter" ParentFont="False" Text="RELAÃÃO DE VISITANTES ORDEM ALFABETICA"/>
      <TfrxMemoView Name="Memo16" ShiftMode="smWhenOverlapped" Left="434,64595" Top="105,82684" Width="71,81107" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Data Nasc."/>
      <TfrxMemoView Name="Memo20" ShiftMode="smWhenOverlapped" Left="332,59864" Top="105,82684" Width="56,69295" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="RG"/>
      <TfrxMemoView Name="Memo21" ShiftMode="smWhenOverlapped" Left="264,5671" Top="105,82684" Width="68,03154" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Ultima Visita"/>
      <TfrxMemoView Name="Memo22" ShiftMode="smWhenOverlapped" Left="0" Top="105,82684" Width="264,5671" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Visitantes:"/>
      <TfrxMemoView Name="Memo11" ShiftMode="smWhenOverlapped" Left="389,29159" Top="105,82684" Width="45,35436" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="UF"/>
      <TfrxMemoView Name="Memo7" ShiftMode="smWhenOverlapped" Left="506,45702" Top="105,82684" Width="75,5906" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Parentesco"/>
      <TfrxMemoView Name="Memo14" ShiftMode="smWhenOverlapped" Left="582,04762" Top="105,82684" Width="75,5906" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Cadastro"/>
      <TfrxMemoView Name="Memo24" ShiftMode="smWhenOverlapped" Left="657,63822" Top="105,82684" Width="60,47248" Height="11,33858268" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="Hora Entr."/>
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="718,1107" Height="52,91342" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]&#13;&#10;[Sqlup.&#34;NOME_UP&#34;]"/>
      <TfrxPictureView Name="Picture4" Left="4,77953" Top="2,11811512" Width="90,70864921" Height="86,92912165" FileLink="..\logo\esquerda.jpg"/>
      <TfrxMemoView Name="Memo6" Left="-359,05535" Top="64,25201" Width="332,59864" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" ParentFont="False" Text="Visitantes"/>
      <TfrxMemoView Name="Memo12" Left="0" Top="54,13389" Width="718,1107" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[Sqlup.&#34;ENDERECO&#34;]  [Sqlup.&#34;NUMERO&#34;]  [Sqlup.&#34;BAIRRO&#34;]  [Sqlup.&#34;COMPLEMENTO&#34;]&#13;&#10;CEP: [Formatmasktext('00.000-000;0',&#60;Sqlup.&#34;CEP&#34;&#62;)] - [Sqlup.&#34;CIDADE&#34;]&#13;&#10;Fone: [Sqlup.&#34;FONE&#34;] - Fax: [Sqlup.&#34;FAX&#34;] -  [Sqlup.&#34;EMAIL&#34;]"/>
      <TfrxPictureView Name="Picture3" Left="604,72480976" Top="1,33859" Width="98,26770921" Height="86,92912165" FileLink="..\logo\direita.jpg"/>
    </TfrxColumnHeader>
    <TfrxPageFooter Name="PageFooter1" Height="18,89765" Left="0" Top="306,14193" Width="718,1107">
      <TfrxMemoView Name="Memo46" Align="baClient" Left="0" Top="0" Width="718,1107" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="Projeto SIAPEN, Impresso em [Date] - [time], Pag. [Page#]/[TotalPages#]"/>
    </TfrxPageFooter>
  </TfrxReportPage>
</TfrxReport>
