<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39864,3926124769" ReportOptions.Description.Text="" ReportOptions.LastChange="41107,6635048958" ScriptLanguage="PascalScript" ScriptText.Text="procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  Database.Params.LoadFromFile('..\config\dbxconnections.ini');&#13;&#10;  SqlListavisitante.Close;&#13;&#10;  SqlListavisitante.Open;&#13;&#10;    &#13;&#10;  while not SqlListavisitante.EOF do&#13;&#10;  begin&#13;&#10;    ComboBoxvisitante.Items.Add(SqlListavisitante.FieldByName('visitante').AsString);&#13;&#10;    SqlListavisitante.Next;&#13;&#10;  end;&#13;&#10;    &#13;&#10;  ComboBoxvisitante.setfocus;&#13;&#10;      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DBLookupComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure frxReport1OnStartReport(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  IF &#60;GLOBAL_VISITANTE&#62; &#60;&#62; 'R' THEN&#13;&#10;  begin&#13;&#10;    SHOWMESSAGE('Não há Permissão Para Visualizar Relatório!');&#13;&#10;    page1.free;&#13;&#10;  end;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ComboBox1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Label1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button3OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." OnStartReport="frxReport1OnStartReport" PropData="044C65667403F80003546F70024808446174617365747301010C3400000020446174615365743D22667278444244617461736574312220446174615365744E616D653D22667278444244617461736574312200010C3200000020446174615365743D2273716C7669736974616E74652220446174615365744E616D653D2273716C7669736974616E74652200010C2E00000020446174615365743D2253716C6D656E6F7265732220446174615365744E616D653D2253716C6D656E6F7265732200010C3C00000020446174615365743D2273716C6C697374617669736974616E74652220446174615365744E616D653D2273716C6C697374617669736974616E74652200010C2400000020446174615365743D2253716C75702220446174615365744E616D653D2253716C7570220000095661726961626C657301010C0D000000204E616D653D2220534941502200010C13000000204E616D653D22444154415F4147454E44412200010C24000000204E616D653D22474C4F42414C5F5649534954414E5445222056616C75653D222752272200010C19000000204E616D653D2249445F5550222056616C75653D223130342200010C3A000000204E616D653D22474C4F42414C5F4F5247414F222056616C75653D2227474F5645524E4F20444F20444953545249544F204645444552414C272200010C45000000204E616D653D22474C4F42414C5F444550415254414D454E544F222056616C75653D222753454352455441524941204445205345475552414EC7412050DA424C494341272200010C49000000204E616D653D22474C4F42414C5F44495245544F524941222056616C75653D22275355425345435245544152494120444F2053495354454D412050454E4954454E4349C152494F27220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxDBXQuery Name="sqlvisitante" UserName="sqlvisitante" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;    v.visitante,&#13;&#10;    v.numero_carteirinha,&#13;&#10;    v.pai,&#13;&#10;    v.mae,&#13;&#10;    v.rg,&#13;&#10;    v.cpf,&#13;&#10;    coalesce(c.cidade||' - '||c.uf,'NÃO INFORMADO') as cidade,&#13;&#10;    list(g.grau_parentesco||': '||i.nome_interno,' / ') NOME_INTERNO                      &#13;&#10;from mov_diario_visitantes md&#13;&#10;inner join visitante v on (v.id_visitante = md.id_visitante)&#13;&#10;inner join visitante_interno vi on (vi.id_visitante = v.id_visitante)&#13;&#10;inner join interno i on (vi.id_interno = i.id_interno)&#13;&#10;inner join grau_parentesco g on (vi.id_grau_parentesco = g.id_grau_parentesco)&#13;&#10;left join cidade c on (v.idcidade = c.id_cidade)&#13;&#10;where visitante = :visitante&#13;&#10;group by&#13;&#10;    v.visitante,&#13;&#10;    v.numero_carteirinha,&#13;&#10;    v.pai,&#13;&#10;    v.mae,&#13;&#10;    v.rg,&#13;&#10;    v.cpf,&#13;&#10;    c.cidade||' - '||c.uf&#13;&#10;&#13;&#10;             " Database="Database" PropData="05704C65667402580470546F70025C0A506172616D657465727301010C49000000204E616D653D227669736974616E7465222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F787669736974616E74652E74657874220000"/>
    <TfrxDBXQuery Name="Sqlmenores" UserName="Sqlmenores" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select&#13;&#10;list(m.nome_menores||' - '||g.grau_parentesco,', ') menores                                       &#13;&#10;from visitante v&#13;&#10;left join visitante_interno vi on (vi.id_visitante = v.id_visitante)&#13;&#10;left join grau_parentesco g on (vi.id_grau_parentesco = g.id_grau_parentesco)&#13;&#10;left join menores m on (m.id_visitante = v.id_visitante)&#13;&#10;where visitante = :visitante    " Database="Database" PropData="05704C65667402540470546F700398000A506172616D657465727301010C49000000204E616D653D227669736974616E7465222044617461547970653D226674537472696E67222045787072657373696F6E3D22636F6D626F626F787669736974616E74652E74657874220000"/>
    <TfrxDBXQuery Name="sqllistavisitante" UserName="sqllistavisitante" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select distinct v.visitante&#13;&#10;from visitante v&#13;&#10;inner join mov_diario_visitantes md on (v.id_visitante = md.id_visitante)&#13;&#10;order by v.visitante&#13;&#10;    &#13;&#10;    " Database="Database" PropData="05704C65667403E8000470546F70025C0A506172616D65746572730100"/>
    <TfrxDBXQuery Name="Sqlup" UserName="Sqlup" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT u.nome_up, u.endereco, u.bairro, u.numero, u.complemento, u.cep,&#13;&#10;c.cidade||' - '||c.uf as cidade, u.fone, u.fax, u.email                     &#13;&#10;from unidade_penal u&#13;&#10;inner join cidade c on(c.id_cidade=u.id_cidade)                                                       &#13;&#10;WHERE ID_UP = :ID_UP  " Database="Database" PropData="05704C65667403A0000470546F700398000A506172616D657465727301010C3F000000204E616D653D2249445F5550222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B49445F5550262336323B220000"/>
    <TfrxDBXDatabase Name="Database" ConnectionName="IBLocal" DriverName="DevartInterBase" GetDriverFunc="getSQLDriverInterBase" LibraryName="dbexpida.dll" LoginPrompt="False" Params.Text="" VendorLib="gds32.DLL" PropData="05704C65667403A0000470546F70025C"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Courier" Font.Style="0" PaperWidth="210" PaperHeight="70" PaperSize="256" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" Columns="2" ColumnWidth="105" ColumnPositions.Text="0&#13;&#10;105" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxPageHeader Name="PageHeader1" Height="241,88974913" Left="0" Top="18,89765" Width="793,7013">
      <TfrxMemoView Name="Memo3" Left="97,48825" Top="35,14963071" Width="185,19697" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="CARTÃƒO DE VISITANTE"/>
      <TfrxPictureView Name="Picture1" Description="Foto" Left="273,78757" Top="57,26775071" Width="109,60624795" Height="109,60622354" DataField="FOTO" DataSet="sqlvisitante" DataSetName="sqlvisitante" Frame.Typ="15"/>
      <TfrxMemoView Name="Memo1" Left="11,77953" Top="57,82681071" Width="249,44898" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="4" ParentFont="False" Text="Nome do Visitante"/>
      <TfrxMemoView Name="Memo6" Left="11,77953" Top="122,0786352" Width="94,48825" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="FiliaÃ§Ã£o"/>
      <TfrxMemoView Name="Memo8" Left="11,77953" Top="88,06275291" Width="128,50402" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="CPF"/>
      <TfrxMemoView Name="Memo21" Left="142,28355" Top="88,06284079" Width="120,94496" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="1" ParentFont="False" Text="RG"/>
      <TfrxMemoView Name="Memo22" Left="403,73253" Top="4,91318079" Width="154,96073" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" Text="Nome do Interno"/>
      <TfrxMemoView Name="Memo38" Left="13,77953" Top="186,11020693" Width="370,39394" Height="52,91342" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Lucida Console" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="CARTEIRA VALIDÃ SOMENTE NO SISTEMA PENITÃªNCIÃRIO DO DISTRITO FEDERAL&#13;&#10;NÃƒO Ã‰ VALIDO COMO DOCUMENTO DE IDENTIDADE"/>
      <TfrxMemoView Name="Memo2" Left="97,48825" Top="3,77953" Width="185,19697" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-7" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="[GLOBAL_ORGAO]&#13;&#10;[GLOBAL_DEPARTAMENTO]&#13;&#10;[GLOBAL_DIRETORIA]"/>
      <TfrxMemoView Name="sqlvisitanteCPF" Left="403,73253" Top="20,03135693" Width="362,83488" Height="60,47248" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;nome_interno&#34;]"/>
      <TfrxMemoView Name="sqlvisitanteGRAU_PARENTESCO" Left="11,77953" Top="99,40134291" Width="128,50394677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="10" ParentFont="False" Text="[sqlvisitante.&#34;CPF&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="403,73253" Top="171,21247882" Width="404,40971" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" Frame.Typ="4" ParentFont="False" VAlign="vaCenter" Text="Expedido em:"/>
      <TfrxMemoView Name="Memo5" Left="11,77953" Top="69,16540071" Width="249,44890677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;VISITANTE&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="142,28355" Top="99,40164071" Width="120,94488677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;RG&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="11,77953" Top="133,41741071" Width="249,44890677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[sqlvisitante.&#34;mae&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="11,77953" Top="148,53553071" Width="249,44890677" Height="18,89765" DataSet="sqlvisitante" DataSetName="sqlvisitante" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="8" ParentFont="False" Text="[sqlvisitante.&#34;pai&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="574,48856" Top="171,21271071" Width="64,25201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="Validade:"/>
      <TfrxBarCodeView Name="BarCode1" Left="523,23655" Top="96,62211071" Width="129" Height="71,81107" BarType="bcCode39" Expression="&#60;sqlvisitante.&#34;NUMERO_CARTEIRINHA&#34;&#62;" Rotation="0" Text="12345678" WideBarRatio="2" Zoom="1"/>
      <TfrxMemoView Name="Memo11" Left="485,66172" Top="173,85838" Width="79,37013" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="0" ParentFont="False" Text="[Date]"/>
      <TfrxMemoView Name="Memo17" Left="645,74057" Top="173,85838" Width="86,92919" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Lucida Console" Font.Style="0" ParentFont="False" Text="[Date + 365]"/>
      <TfrxPictureView Name="Picture3" Left="315,21278344" Top="3,77953" Width="43,84250553" Height="47,43954828" FileLink="..\logo\direita.jpg"/>
      <TfrxPictureView Name="Picture4" Left="20,77953" Top="1,69426849" Width="43,84250553" Height="47,43954828" FileLink="..\logo\esquerda.jpg"/>
    </TfrxPageHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Height="166" Left="350" Top="115" Width="503" OnShow="DialogPage1OnShow">
    <TfrxLabelControl Name="Label1" Left="20" Top="12" Width="85" Height="23" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Tahoma" Font.Style="1" ParentFont="False" Caption="Visitante" Color="15854311" OnClick="Label1OnClick"/>
    <TfrxButtonControl Name="Button1" Left="136" Top="92" Width="75" Height="25" Caption="OK" ModalResult="1"/>
    <TfrxButtonControl Name="Button2" Left="252" Top="92" Width="75" Height="25" Caption="Cancelar" ModalResult="5"/>
    <TfrxComboBoxControl Name="ComboBoxvisitante" Left="20" Top="44" Width="449" Height="21" Color="-16777211" Items.Text="" ItemIndex="-1" OnClick="ComboBox1OnClick"/>
  </TfrxDialogPage>
</TfrxReport>
